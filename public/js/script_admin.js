function echo(e){}function showChain(e){e.fadeTo("fast",1,function(){$(this).next().length&&showChain($(this).next())})}function viewport(){var e=window,t="inner";return"innerWidth"in window||(t="client",e=document.documentElement||document.body),{width:e[t+"Width"],height:e[t+"Height"]}}function getUserAjax(e,t){$.ajax({url:e,headers:{"X-CSRF-TOKEN":t},type:"POST",beforeSend:function(){},success:function(e){$("#user-edit-form input[name=id]").val(e.id),$("#user-edit-form input[name=name]").val(e.name),$("#user-edit-form input[name=email]").val(e.email),$("#user-edit-modal").modal("show")},error:function(e,t,a,r){}})}function getPropertyAjax(e,t){$.ajax({url:e,headers:{"X-CSRF-TOKEN":t},type:"POST",beforeSend:function(){$("#property-edit-modal .alert").remove()},success:function(e){$("#property-edit-form input[name=id]").val(e.id),$("#property-edit-form input[name=property_name]").val(e.property_name),$("#property-edit-form input[name=property_class]").val(e.property_class),$("#property-edit-form select[name=property_group]").val(e.property_group),$("#property-edit-modal").modal("show")},error:function(e,t,a,r){}})}function updateUserAjax(e,t){$.ajax({url:e.url,headers:{"X-CSRF-TOKEN":t},data:e,type:"POST",beforeSend:function(){},success:function(t){if($("#user-edit-form .form-group").removeClass("has-error"),$("#user-edit-form .form-group span").remove(),$("#user-edit-modal .alert").remove(),$("#user-edit-form .user-password input").val(""),t.success){$("#user-edit-modal .modal-body").append('<div class="alert alert-success alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+t.success+"</div>");var a=$("tr[data-id="+e.id+"]");a.find(".user-name a").html(t.result.name),a.find(".user-email a").html(t.result.email),a.find(".user-updated_at").html(t.result.updated_at)}else $("#user-edit-modal .modal-body").append('<div class="alert alert-danger alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+t.error+"</div>")},error:function(e,t,a,r){$("#user-edit-form .form-group").removeClass("has-error"),$("#user-edit-form .form-group span").remove(),$("#user-edit-modal .alert").remove(),422==e.status&&$.each(e.responseJSON,function(e,t){switch(e){case"name":$.each(t,function(){$("#user-edit-form .user-name").addClass("has-error").append('<span class="help-block">'+this+"</span>")});break;case"email":$.each(t,function(){$("#user-edit-form .user-email").addClass("has-error").append('<span class="help-block">'+this+"</span>")});break;case"password":$.each(t,function(){$("#user-edit-form .user-password").addClass("has-error").append('<span class="help-block">'+this+"</span>")})}})}})}function updatePropertyAjax(e,t){$.ajax({url:e.url,headers:{"X-CSRF-TOKEN":t},data:e,type:"POST",beforeSend:function(){},success:function(t){if($("#property-edit-form .form-group").removeClass("has-error"),$("#property-edit-form .form-group span").remove(),$("#property-edit-modal .alert").remove(),t.success){$("#property-edit-modal .modal-body").append('<div class="alert alert-success alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+t.success+"</div>");var a=$("tr[data-id="+e.id+"]");a.find(".property-icon span").attr("class",t.result.property_class),a.find(".property-name").html(t.result.property_name),a.find(".property-class").html(t.result.property_class),a.find(".property-group").html(t.result.property_group)}else $("#property-edit-modal .modal-body").append('<div class="alert alert-danger alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+t.error+"</div>")},error:function(e,t,a,r){$("#property-edit-form .form-group").removeClass("has-error"),$("#property-edit-form .form-group span").remove(),$("#property-edit-modal .alert").remove(),422==e.status&&$.each(e.responseJSON,function(e,t){switch(e){case"name":$.each(t,function(){$("#property-edit-form .property-name").addClass("has-error").append('<span class="help-block">'+this+"</span>")});break;case"email":$.each(t,function(){$("#property-edit-form .property-class").addClass("has-error").append('<span class="help-block">'+this+"</span>")})}})}})}function deleteGalleryItemAjax(e,t,a){$.ajax({url:e,headers:{"X-CSRF-TOKEN":t},type:"POST",beforeSend:function(){a.find(".item-error").remove()},success:function(e){e.success?a.remove():$("#ajax-response").html('<div class="alert alert-danger alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+e.error+"</div>")},error:function(e,t,a,r){}})}function setGalleryFields(e){switch(e){case"video_embed":$("#item-url").hide(),$("#item-url").find("input[name=item_url]").val(""),$("#item-alt").find("input[name=item_alt]").val(""),$("#item-embed").show();break;case"video":$("#item-url").show(),$("#item-alt").hide(),$("#item-alt").find("input[name=item_alt]").val(""),$("#item-embed").hide(),$("#item-embed").find("input[name=item_embed]").val("");break;default:$("#item-url").show(),$("#item-alt").show(),$("#item-embed").hide(),$("#item-embed").find("input[name=item_embed]").val("")}}function setGalleryForm(){var e=$("#project-edit-form select[name=item_type]").val();setGalleryFields(e)}function deleteProjectPropertyAjax(e,t,a,r){$.ajax({url:e,headers:{"X-CSRF-TOKEN":t},type:"POST",beforeSend:function(){},success:function(e){if(e.success){var t='<li class="text-center property-add" data-id="'+r.data("property_id")+'">'+r.html();r.remove(),$(".all-properties-list").append(t)}else $("#ajax-response").html('<div class="alert alert-danger alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+e.error+"</div>")},error:function(e,t,a,r){}})}function setStatusAjax(e,t){$.ajax({url:e.url,data:{id:e.id},headers:{"X-CSRF-TOKEN":t},type:"POST",beforeSend:function(){$("#alert-holder").empty()},success:function(t){t.success?(e.node.attr("class",e["class"]),$("#alert-holder").append('<div class="alert alert-success alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+t.success+"</div>")):$("#alert-holder").append('<div class="alert alert-danger alert-dismissible" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+t.error+"</div>")},error:function(e,t,a,r){}})}$(document).on("click",".btn-edit",function(e){e=e||window.event,e.preventDefault();var t=$(this).attr("href"),a=$(this).data("token");$(this).hasClass("btn-editproperty")?getPropertyAjax(t,a):getUserAjax(t,a)}),$(document).on("click",".btn-update-user",function(){var e=$(this).data("token"),t={};t.url=$("#user-edit-form").attr("action"),t.id=$("#user-edit-form input[name=id]").val(),t.name=$("#user-edit-form input[name=name]").val(),t.email=$("#user-edit-form input[name=email]").val(),t.password=$("#user-edit-form input[name=password]").val(),updateUserAjax(t,e)}),$(document).on("click",".btn-update-property",function(){var e=$(this).data("token"),t={};t.url=$("#property-edit-form").attr("action"),t.id=$("#property-edit-form input[name=id]").val(),t.property_name=$("#property-edit-form input[name=property_name]").val(),t.property_class=$("#property-edit-form input[name=property_class]").val(),t.property_group=$("#property-edit-form select[name=property_group]").val(),updatePropertyAjax(t,e)}),$(document).on("change","#project-edit-form select[name=item_type]",function(){var e=$(this).val();setGalleryFields(e)}),$(window).load(function(){$("#gallery .gallery-item").height(10*$("#gallery .gallery-item").width()/16)}),$(document).on("click",".gallery-item .btn-delete",function(){var e=$("#project-edit-form input[name=_token]").val(),t=$(this).data("url"),a=$(this).parent(".gallery-item");deleteGalleryItemAjax(t,e,a)}),$(document).on("click",".property-add",function(){var e=$(this).html(),t=$(this).data("id").toString(),a=$("#properties-toadd"),r=$("input[name=properties_toadd]"),s=r.val();if(""==s)r.val(t),a.append('<li class="text-center" data-id="'+t+'">'+e+"</li>");else{var i=s.split(",");$.inArray(t,i)>=0?(i=$.grep(i,function(e){return e!=t}),s=i.join(),a.find("li[data-id="+t+"]").remove()):(s=i.join(),s=s+","+t,a.append('<li class="text-center" data-id="'+t+'">'+e+"</li>")),r.val(s)}}),$(document).on("click",".project-properties .property-remove",function(){var e=confirm("Delete property?");if(!e)return!1;var t=$("#project-edit-form input[name=_token]").val(),a=$(this).data("url"),r=$(this).data("property_id"),s=$(this);deleteProjectPropertyAjax(a,t,r,s)}),$(document).on("change","#set-status",function(){var e=$("#_token").data("token"),t={};t.url=$(this).data("url"),t["class"]=$(this).find(":selected").data("class"),t.id=$(this).val(),t.node=$(this).parents("tr"),setStatusAjax(t,e)}),$(document).on("ajaxStart",function(){$(".loadanimation").show()}),$(document).on("ajaxStop",function(){$(".loadanimation").hide()}),$(document).ajaxError(function(e,t,a,r){}),$(function(){$('[data-toggle="tooltip"]').tooltip(),setGalleryForm(),$(".tinymce-field").length&&tinymce.init({selector:".tinymce-field",height:300,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste code"],toolbar:"insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image"})});