{"version":3,"sources":["script_admin.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"script_admin.js","sourcesContent":["/*\n * console.log();\n */\nfunction echo(string){\n\tconsole.log(string);\n}\n////////////////////////////////////////////////////////////////////////\n\n/*****************************************\n *\tGlobal variables\n *****************************************/\n\n/*****************************************\n *\tFunctions\n *****************************************/\n //chain fadeTo animation\nfunction showChain(elem){\n\telem.fadeTo('fast', 1, function(){\n\t\t$(this).next().length && showChain($(this).next());\n\t});\n}\n//return cross-browser window width & height\nfunction viewport() {\n\tvar e = window, a = 'inner';\n\tif (!('innerWidth' in window)) {\n\t\ta = 'client';\n\t\te = document.documentElement || document.body;\n\t}\n\treturn { width : e[ a+'Width' ] , height : e[ a+'Height' ] };\n}\n//return user for editing\nfunction getUserAjax(url, token){\n\t$.ajax({\n\t\turl:url,\n\t\theaders: {'X-CSRF-TOKEN': token},\n\t\t//data:{_token: token},\n\t\ttype:'POST',\n\t\tbeforeSend: function(){\n\t\t},\n\t\tsuccess: function(json){\n\t\t\t//var res = JSON.parse(json);\n\t\t\t//echo(json);\n\t\t\t//echo(token);\n\t\t\t$('#user-edit-form input[name=id]').val(json.id);\n\t\t\t$('#user-edit-form input[name=name]').val(json.name);\n\t\t\t$('#user-edit-form input[name=email]').val(json.email);\n\t\t\t$('#user-edit-modal').modal('show');\n\t\t},\n\t\terror: function(event, jqxhr, settings, thrownError){\n\t\t\tconsole.log(event);\n\t\t\tconsole.log(jqxhr);\n\t\t\tconsole.log(settings);\n\t\t\tconsole.log(thrownError);\n\t\t}\n\t});\n}\n//return project property for editing\nfunction getPropertyAjax(url, token){\n\t$.ajax({\n\t\turl:url,\n\t\theaders: {'X-CSRF-TOKEN': token},\n\t\t//data:{_token: token},\n\t\ttype:'POST',\n\t\tbeforeSend: function(){\n\t\t\t$('#property-edit-modal .alert').remove();\n\t\t},\n\t\tsuccess: function(json){\n\t\t\t//var res = JSON.parse(json);\n\t\t\t//echo(json);\n\t\t\t//echo(token);\n\t\t\t$('#property-edit-form input[name=id]').val(json.id);\n\t\t\t$('#property-edit-form input[name=property_name]').val(json.property_name);\n\t\t\t$('#property-edit-form input[name=property_class]').val(json.property_class);\n\t\t\t$('#property-edit-form select[name=property_group]').val(json.property_group);\n\t\t\t$('#property-edit-modal').modal('show');\n\t\t},\n\t\terror: function(event, jqxhr, settings, thrownError){\n\t\t\tconsole.log(event);\n\t\t\tconsole.log(jqxhr);\n\t\t\tconsole.log(settings);\n\t\t\tconsole.log(thrownError);\n\t\t}\n\t});\n}\n//update user\nfunction updateUserAjax(data, token){\n\t$.ajax({\n\t\turl:data.url,\n\t\theaders: {'X-CSRF-TOKEN': token},\n\t\tdata: data,\n\t\ttype:'POST',\n\t\tbeforeSend: function(){\n\t\t},\n\t\tsuccess: function(json){\n\t\t\t$('#user-edit-form .form-group').removeClass('has-error');\n\t\t\t$('#user-edit-form .form-group span').remove();\n\t\t\t$('#user-edit-modal .alert').remove();\n\t\t\t$('#user-edit-form .user-password input').val('');\n\n\t\t\tif(json.success){\n\t\t\t\t$('#user-edit-modal .modal-body').append('<div class=\"alert alert-success alert-dismissible\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>'+json.success+'</div>');\n\t\t\t\tvar row = $('tr[data-id='+data.id+']');\n\t\t\t\trow.find('.user-name a').html(json.result.name);\n\t\t\t\trow.find('.user-email a').html(json.result.email);\n\t\t\t\trow.find('.user-updated_at').html(json.result.updated_at);\n\t\t\t} else {\n\t\t\t\t$('#user-edit-modal .modal-body').append('<div class=\"alert alert-danger alert-dismissible\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>'+json.error+'</div>');\n\t\t\t}\n\t\t},\n\t\terror: function(event, jqxhr, settings, thrownError){\n\t\t\t$('#user-edit-form .form-group').removeClass('has-error');\n\t\t\t$('#user-edit-form .form-group span').remove();\n\t\t\t$('#user-edit-modal .alert').remove();\n\t\t\tif(event.status == 422){\n\t\t\t\t$.each(event.responseJSON, function(key, value){\n\t\t\t\t\tswitch(key){\n\t\t\t\t\t\tcase 'name':\n\t\t\t\t\t\t\t$.each(value, function(){\n\t\t\t\t\t\t\t\t$('#user-edit-form .user-name').addClass('has-error').append('<span class=\"help-block\">' + this + '</span>');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'email':\n\t\t\t\t\t\t\t$.each(value, function(){\n\t\t\t\t\t\t\t\t$('#user-edit-form .user-email').addClass('has-error').append('<span class=\"help-block\">' + this + '</span>');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'password':\n\t\t\t\t\t\t\t$.each(value, function(){\n\t\t\t\t\t\t\t\t$('#user-edit-form .user-password').addClass('has-error').append('<span class=\"help-block\">' + this + '</span>');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconsole.log(event);\n\t\t\t\tconsole.log(jqxhr);\n\t\t\t\tconsole.log(settings);\n\t\t\t\tconsole.log(thrownError);\n\t\t\t}\n\t\t}\n\t});\n}\n//update project property\nfunction updatePropertyAjax(data, token){\n\t$.ajax({\n\t\turl:data.url,\n\t\theaders: {'X-CSRF-TOKEN': token},\n\t\tdata: data,\n\t\ttype:'POST',\n\t\tbeforeSend: function(){\n\t\t},\n\t\tsuccess: function(json){\n\t\t\t$('#property-edit-form .form-group').removeClass('has-error');\n\t\t\t$('#property-edit-form .form-group span').remove();\n\t\t\t$('#property-edit-modal .alert').remove();\n\n\t\t\tif(json.success){\n\t\t\t\t$('#property-edit-modal .modal-body').append('<div class=\"alert alert-success alert-dismissible\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>'+json.success+'</div>');\n\t\t\t\tvar row = $('tr[data-id='+data.id+']');\n\t\t\t\trow.find('.property-icon span').attr('class', json.result.property_class);\n\t\t\t\trow.find('.property-name').html(json.result.property_name);\n\t\t\t\trow.find('.property-class').html(json.result.property_class);\n\t\t\t\trow.find('.property-group').html(json.result.property_group);\n\t\t\t} else {\n\t\t\t\t$('#property-edit-modal .modal-body').append('<div class=\"alert alert-danger alert-dismissible\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>'+json.error+'</div>');\n\t\t\t}\n\t\t},\n\t\terror: function(event, jqxhr, settings, thrownError){\n\t\t\t$('#property-edit-form .form-group').removeClass('has-error');\n\t\t\t$('#property-edit-form .form-group span').remove();\n\t\t\t$('#property-edit-modal .alert').remove();\n\t\t\tif(event.status == 422){\n\t\t\t\t$.each(event.responseJSON, function(key, value){\n\t\t\t\t\tswitch(key){\n\t\t\t\t\t\tcase 'name':\n\t\t\t\t\t\t\t$.each(value, function(){\n\t\t\t\t\t\t\t\t$('#property-edit-form .property-name').addClass('has-error').append('<span class=\"help-block\">' + this + '</span>');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'email':\n\t\t\t\t\t\t\t$.each(value, function(){\n\t\t\t\t\t\t\t\t$('#property-edit-form .property-class').addClass('has-error').append('<span class=\"help-block\">' + this + '</span>');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconsole.log(event);\n\t\t\t\tconsole.log(jqxhr);\n\t\t\t\tconsole.log(settings);\n\t\t\t\tconsole.log(thrownError);\n\t\t\t}\n\t\t}\n\t});\n}\n//delete project gallery item\nfunction deleteGalleryItemAjax(url, token, item){\n\t$.ajax({\n\t\turl:url,\n\t\theaders: {'X-CSRF-TOKEN': token},\n\t\ttype:'POST',\n\t\tbeforeSend: function(){\n\t\t\titem.find('.item-error').remove();\n\t\t},\n\t\tsuccess: function(json){\n\t\t\tif(json.success)\n\t\t\t\titem.remove();\n\t\t\telse\n\t\t\t\t$('#ajax-response').html('<div class=\"alert alert-danger alert-dismissible\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>'+json.error+'</div>');\n\t\t},\n\t\terror: function(event, jqxhr, settings, thrownError){\n\t\t\tconsole.log(event);\n\t\t\tconsole.log(jqxhr);\n\t\t\tconsole.log(settings);\n\t\t\tconsole.log(thrownError);\n\t\t}\n\t});\n}\n//edit project: set form field visibility\nfunction setGalleryFields(type){\n\tswitch(type){\n\t\tcase 'video_embed':\n\t\t\t$('#item-url').hide();\n\t\t\t$('#item-url').find('input[name=item_url]').val('');\n\t\t\t$('#item-alt').find('input[name=item_alt]').val('');\n\t\t\t$('#item-embed').show();\n\t\t\tbreak;\n\t\tcase 'video':\n\t\t\t$('#item-url').show();\n\t\t\t$('#item-alt').hide();\n\t\t\t$('#item-alt').find('input[name=item_alt]').val('');\n\t\t\t$('#item-embed').hide();\n\t\t\t$('#item-embed').find('input[name=item_embed]').val('');\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t$('#item-url').show();\n\t\t\t$('#item-alt').show();\n\t\t\t$('#item-embed').hide();\n\t\t\t$('#item-embed').find('input[name=item_embed]').val('');\n\t}\n}\nfunction setGalleryForm(){\n\tvar val = $('#project-edit-form select[name=item_type]').val();\n\tsetGalleryFields(val);\n}\n//delete project property\nfunction deleteProjectPropertyAjax(url, token, property_id, item){\n\t$.ajax({\n\t\turl:url,\n\t\theaders: {'X-CSRF-TOKEN': token},\n\t\ttype:'POST',\n\t\tbeforeSend: function(){\n\t\t\t\n\t\t},\n\t\tsuccess: function(json){\n\t\t\tif(json.success){\n\t\t\t\tvar html = '<li class=\"text-center property-add\" data-id=\"' + item.data('property_id')  + '\">' + item.html(); + '</li>';\n\t\t\t\titem.remove();\n\t\t\t\t$('.all-properties-list').append(html);\n\t\t\t}\n\t\t\telse\n\t\t\t\t$('#ajax-response').html('<div class=\"alert alert-danger alert-dismissible\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>'+json.error+'</div>');\n\t\t},\n\t\terror: function(event, jqxhr, settings, thrownError){\n\t\t\tconsole.log(event);\n\t\t\tconsole.log(jqxhr);\n\t\t\tconsole.log(settings);\n\t\t\tconsole.log(thrownError);\n\t\t}\n\t});\n}\n//set message status\nfunction setStatusAjax(data, token){\n\t$.ajax({\n\t\turl:data.url,\n\t\tdata: {id: data.id},\n\t\theaders: {'X-CSRF-TOKEN': token},\n\t\ttype:'POST',\n\t\tbeforeSend: function(){\n\t\t\t$('#alert-holder').empty();\n\t\t},\n\t\tsuccess: function(json){\n\t\t\tif(json.success){\n\t\t\t\tdata.node.attr('class', data.class);\n\t\t\t\t$('#alert-holder').append('<div class=\"alert alert-success alert-dismissible\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>'+json.success+'</div>');\n\t\t\t}\n\t\t\telse\n\t\t\t\t$('#alert-holder').append('<div class=\"alert alert-danger alert-dismissible\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>'+json.error+'</div>');\n\t\t},\n\t\terror: function(event, jqxhr, settings, thrownError){\n\t\t\tconsole.log(event);\n\t\t\tconsole.log(jqxhr);\n\t\t\tconsole.log(settings);\n\t\t\tconsole.log(thrownError);\n\t\t}\n\t});\n}\n/*****************************************\n *\tEvent listeners\n *****************************************/\n//edit user button\n$(document).on('click', '.btn-edit', function(e){\n\te=e||window.event;\n\te.preventDefault();\n\n\tvar url = $(this).attr('href');\n\tvar token = $(this).data('token');\n\tif($(this).hasClass('btn-editproperty'))\n\t\tgetPropertyAjax(url, token);\n\telse\n\t\tgetUserAjax(url, token);\n});\n//update user pop-up button\n$(document).on('click', '.btn-update-user', function(){\n\tvar token = $(this).data('token'),\n\t\tdata = {};\n\n\tdata.url = $('#user-edit-form').attr('action');\t\n\tdata.id = $('#user-edit-form input[name=id]').val();\n\tdata.name = $('#user-edit-form input[name=name]').val();\n\tdata.email = $('#user-edit-form input[name=email]').val();\n\tdata.password = $('#user-edit-form input[name=password]').val();\n\n\tupdateUserAjax(data, token);\n});\n//update project properties pop-up button\n$(document).on('click', '.btn-update-property', function(){\n\tvar token = $(this).data('token'),\n\t\tdata = {};\n\n\tdata.url = $('#property-edit-form').attr('action');\t\n\tdata.id = $('#property-edit-form input[name=id]').val();\n\tdata.property_name = $('#property-edit-form input[name=property_name]').val();\n\tdata.property_class = $('#property-edit-form input[name=property_class]').val();\n\tdata.property_group = $('#property-edit-form select[name=property_group]').val();\n\n\tupdatePropertyAjax(data, token);\n});\n//edit project\n$(document).on('change', '#project-edit-form select[name=item_type]', function(){\n\tvar val = $(this).val();\n\tsetGalleryFields(val);\n});\n$(window).load(function(){\n\t$('#gallery .gallery-item').height($('#gallery .gallery-item').width()*10/16);\n});\n//delete projects gallery item\n$(document).on('click', '.gallery-item .btn-delete', function(){\n\tvar token = $('#project-edit-form input[name=_token]').val(),\n\t\turl = $(this).data('url'),\n\t\titem = $(this).parent('.gallery-item');\n\n\tdeleteGalleryItemAjax(url, token, item);\n});\n//delete projects gallery item\n$(document).on('click', '.property-add', function(){\n\tvar html = $(this).html(),\n\t    id = $(this).data('id').toString(),\n\t    list = $('#properties-toadd'),\n\t    input = $('input[name=properties_toadd]'),\n\t    val = input.val();\n\n\tif(val == ''){\n\t\tinput.val(id);\n\t\tlist.append('<li class=\"text-center\" data-id=\"' + id + '\">' + html + '</li>');\n\t} else {\n\t\tvar chunks = val.split(',');\n\t\tif($.inArray(id, chunks) >= 0){\n\t\t\tchunks = $.grep(chunks, function(value) {\n\t\t\t\treturn value != id;\n\t\t\t});\n\t\t\tval = chunks.join();\n\t\t\tlist.find('li[data-id='+ id +']').remove();\n\t\t} else {\n\t\t\tval = chunks.join();\n\t\t\tval = val + ',' + id;\n\t\t\tlist.append('<li class=\"text-center\" data-id=\"' + id + '\">' + html + '</li>');\n\t\t}\n\t\tinput.val(val);\n\t}\n\n});\n//delete project property\n$(document).on('click', '.project-properties .property-remove', function(){\n\tvar a = confirm('Delete property?');\n\tif(a){\t\n\t\tvar token = $('#project-edit-form input[name=_token]').val(),\n\t\t\turl = $(this).data('url'),\n\t\t\tproperty_id = $(this).data('property_id'),\n\t\t\titem = $(this);\n\n\t\tdeleteProjectPropertyAjax(url, token, property_id, item);\n\t} else return false;\n});\n//change message status\n$(document).on('change', '#set-status', function(){\n\tvar token = $('#_token').data('token'),\n\t\tdata = {};\n\tdata.url = $(this).data('url');\n\tdata.class = $(this).find(':selected').data('class');\n\tdata.id = $(this).val();\n\tdata.node = $(this).parents('tr');\n\n\tsetStatusAjax(data, token);\n});\n/*****************************************\n *\n *\tAJAX load & errors\n *\n *****************************************/\n\t$(document).on('ajaxStart', function(){\n\t\t$('.loadanimation').show();\n\t});\n\t$(document).on('ajaxStop', function(){\n\t\t$('.loadanimation').hide();\n\t});\n\t$(document).ajaxError(function(event, jqxhr, settings, thrownError){\n\t\tconsole.log(event);\n\t\tconsole.log(jqxhr.responseText);\n\t\tconsole.log(settings);\n\t\tconsole.log(thrownError);\n\t});\n/*****************************************\n *\tdocument ready function\n *****************************************/\n$(function(){\n\t$('[data-toggle=\"tooltip\"]').tooltip();\n\tsetGalleryForm();\n\n\tif($('.tinymce-field').length){\n\t\ttinymce.init({\n\t\t  selector: '.tinymce-field',\n\t\t  height: 300,\n\t\t  plugins: [\n\t\t    'advlist autolink lists link image charmap print preview anchor',\n\t\t    'searchreplace visualblocks code fullscreen',\n\t\t    'insertdatetime media table contextmenu paste code'\n\t\t  ],\n\t\t  toolbar: 'insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image'\n\t\t});\n\t}\n});"],"sourceRoot":"/source/"}